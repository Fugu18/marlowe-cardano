testName: Zero Coupon Bond Contract Test

operations:
  - CreateWallet:
      walletNickname: Lender

  - CreateWallet:
      walletNickname: Borrower

  - FundWallets:
      values: [20000000]
      walletNicknames: [Lender, Borrower]

  # Minting role tokens
  - Mint:
      issuer: Faucet
      currencyNickname: RoleCurrency
      minLovelace: 2000000
      tokenDistribution:
        - [Borrower, BorrowerRoleToken, 1]
        - [Lender, LenderRoleToken, 1]

  # Sanity check
  - CheckBalance:
      walletNickname: Borrower
      balance:
        - [ADA, 22]
        - [RoleCurrency, BorrowerRoleToken, 1]

  # Sanity check
  - CheckBalance:
      walletNickname: Lender
      balance:
        - [ADA, 22]
        - [RoleCurrency, LenderRoleToken, 1]

  # Transaction 1. Create the Contract by Providing the Minimum ADA
  - Initialize:
      marloweValidators: referenceCurrent
      roleCurrency: RoleCurrency
      contractNickname: ZCB
      minLovelace: 2000000
      contractSource:
        template:
          UseZeroCouponBond:
            lender:
              role_token: LenderRoleToken
            borrower:
              role_token: BorrowerRoleToken
            principal: 10000000
            interest: 5000000
            lendingDeadline:
              relative: 20000
            paybackDeadline:
              relative: 30000

  # Transaction 2. Lender Deposits the Loan Amount
  - Prepare:
      contractNickname: ZCB
      inputs:
        - input_from_party:
            role_token: LenderRoleToken
          that_deposits: 10000000
          of_token:
            currency_symbol: ""
            token_name: ""
          into_account:
            role_token: LenderRoleToken
      minimumTime:
        relative: -15
      maximumTime:
        relative: 3600

  - AutoRun:
      contractNickname: ZCB

  - CheckBalance:
      walletNickname: Lender
      balance:
        - [ADA, [11, 12]]
        - [RoleCurrency, LenderRoleToken, 1]

  # Sanity check
  - CheckBalance:
      walletNickname: Borrower
      balance:
        - [ADA, 22]
        - [RoleCurrency, BorrowerRoleToken, 1]

  - Withdraw:
      contractNickname: ZCB
      walletNickname: Borrower

  # Sanity check
  - CheckBalance:
      walletNickname: Borrower
      balance:
        - [ADA, [31, 32]]
        - [RoleCurrency, BorrowerRoleToken, 1]

  # Transaction 3. Borrower Repays the Loan's Principal and Interest"
  - Prepare:
      contractNickname: ZCB
      inputs:
        - input_from_party:
            role_token: BorrowerRoleToken
          that_deposits: 15000000
          of_token:
            currency_symbol: ""
            token_name: ""
          into_account:
            role_token: BorrowerRoleToken
      minimumTime:
        relative: -15
      maximumTime:
        relative: 3600

  - AutoRun:
      contractNickname: ZCB

  - CheckBalance:
      walletNickname: Borrower
      balance:
        - [ADA, [16, 17]]
        - [RoleCurrency, BorrowerRoleToken, 1]

  - CheckBalance:
      walletNickname: Lender
      balance:
        - [ADA, [11, 12]]
        - [RoleCurrency, LenderRoleToken, 1]

  - Withdraw:
      contractNickname: ZCB
      walletNickname: Lender

  - CheckBalance:
      walletNickname: Lender
      balance:
        - [ADA, [26, 27]]
        - [RoleCurrency, LenderRoleToken, 1]
