testName: Non-PAB Swap Contract Test

operations:
  - tag: Publish
    publishPermanently: true

  - tag: CreateWallet
    walletNickname: aParty

  - tag: FundWallets
    values:
      - 100000000
    walletNicknames: [aParty]

  - tag: CreateWallet
    walletNickname: bParty

  - tag: FundWallets
    values:
      - 100000000
    walletNicknames: [bParty]

  - tag: Mint
    currencyNickname: Swap
    tokenDistribution:
      - [ aParty, aParty, 1 ]
      - [ bParty, bParty, 1 ]


  # Minting tokens aParty will use in the swap
  - tag: Mint
    currencyNickname: aPartyCurrency
    issuer: aParty
    tokenDistribution:
      - [ aParty, Globe, 300]

  # Minting tokens bParty will use in the swap
  - tag: Mint
    currencyNickname: bPartyCurrency
    issuer: bParty
    tokenDistribution:
      - [ bParty, Swan, 500]

  - tag: Initialize
    contractNickname: Swap
    minAda: 3000000
    roleCurrency: Swap
    contractSource:
      template:
        tag: UseSwap
        utAParty:
          role_token: aParty
        utACurrencyNickname: aPartyCurrency
        utATokenName:
          unTokenName: Globe
        utAAmount: 300
        # Threre are three timeouts in the contract calculated from this value:
        # `timeout`, `timeout-1000`, `timeout-2000`
        utATimeout:
          relative: 1000000
        utBParty:
          role_token: bParty
        utBCurrencyNickname: bPartyCurrency
        utBTokenName:
          unTokenName: Swan
        utBAmount: 500
        # Threre are three timeouts in the contract calculated from this value:
        # `timeout`, `timeout-1000`, `timeout-2000`
        utBTimeout:
          relative: 1000000

  - tag: Prepare
    contractNickname: Swap
    inputs:
      - input_from_party:
          role_token: aParty
        that_deposits: 300
        of_token:
          currency_symbol: aPartyCurrency
          token_name: Globe
        into_account:
          role_token: aParty
    minimumTime:
      relative: -1000
    maximumTime:
      relative: 8000

  - tag: Prepare
    contractNickname: Swap
    inputs:
      - input_from_party:
          role_token: bParty
        that_deposits: 500
        of_token:
          currency_symbol: bPartyCurrency
          token_name: Swan
        into_account:
          role_token: bParty
    minimumTime:
      relative: -1000
    maximumTime:
      relative: 8000

  - tag: AutoRun
    contractNickname: Swap

  - tag: Withdraw
    contractNickname: Swap
    walletNickname: aParty

  - tag: Withdraw
    contractNickname: Swap
    walletNickname: bParty

  - tag: CheckBalance
    walletNickname: aParty
    balance:
      - [Swap, aParty, 1]
      - [bPartyCurrency, Swan, 500]
      - [Ada, 100]
      - [Ada, 1.193870]

  - tag: CheckBalance
    walletNickname: bParty
    balance:
      - [Swap, bParty, 1]
      - [aPartyCurrency, Globe, 300]
      - [Ada, 100]
      - [Ada, 1.193870]

  - tag: BurnAll
    currencyNickname: aPartyCurrency

  - tag: BurnAll
    currencyNickname: bPartyCurrency


