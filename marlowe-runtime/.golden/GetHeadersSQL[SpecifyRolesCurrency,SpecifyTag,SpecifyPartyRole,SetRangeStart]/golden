Delimiter statement: WITH partyRoles (rolesCurrency, role) AS (SELECT * FROM UNNEST($1, $2)) SELECT createTxOut.txId, createTxOut.txIx, createTxOut.slotNo FROM marlowe.createTxOut NATURAL JOIN marlowe.contractTxOut NATURAL JOIN UNNEST($3) AS roles (rolesCurrency) WHERE ((createTxOut.txId = $4 AND createTxOut.txIx = $5) AND (EXISTS (SELECT 1 FROM marlowe.contractTxOutTag NATURAL JOIN UNNEST($6) AS tags (tag) WHERE contractTxOutTag.txId = createTxOut.txId AND contractTxOutTag.txIx = createTxOut.txIx))) AND (EXISTS (SELECT 1 FROM marlowe.contractTxOutPartyRole NATURAL JOIN partyRoles WHERE createTxOut.txId = contractTxOutPartyRole.createTxId AND createTxOut.txIx = contractTxOutPartyRole.createTxIx))
Total count statement: WITH partyRoles (rolesCurrency, role) AS (SELECT * FROM UNNEST($1, $2)) SELECT count(*) FROM marlowe.createTxOut NATURAL JOIN marlowe.contractTxOut NATURAL JOIN UNNEST($3) AS roles (rolesCurrency) WHERE (EXISTS (SELECT 1 FROM marlowe.contractTxOutTag NATURAL JOIN UNNEST($4) AS tags (tag) WHERE contractTxOutTag.txId = createTxOut.txId AND contractTxOutTag.txIx = createTxOut.txIx)) AND (EXISTS (SELECT 1 FROM marlowe.contractTxOutPartyRole NATURAL JOIN partyRoles WHERE createTxOut.txId = contractTxOutPartyRole.createTxId AND createTxOut.txIx = contractTxOutPartyRole.createTxIx))
Headers statement: WITH partyRoles (rolesCurrency, role) AS (SELECT * FROM UNNEST($1, $2)) SELECT createTxOut.slotNo, createTxOut.blockId, createTxOut.blockNo, createTxOut.txId, createTxOut.txIx, contractTxOut.rolesCurrency, createTxOut.metadata, txOut.address, contractTxOut.payoutScriptHash FROM marlowe.createTxOut NATURAL JOIN marlowe.contractTxOut NATURAL JOIN marlowe.txOut NATURAL JOIN UNNEST($3) AS roles (rolesCurrency) WHERE ((createTxOut.slotNo < $4 OR (createTxOut.slotNo = $4 AND (createTxOut.txId < $5 OR (createTxOut.txId = $5 AND createTxOut.txIx <= $6)))) AND (EXISTS (SELECT 1 FROM marlowe.contractTxOutTag NATURAL JOIN UNNEST($7) AS tags (tag) WHERE contractTxOutTag.txId = createTxOut.txId AND contractTxOutTag.txIx = createTxOut.txIx))) AND (EXISTS (SELECT 1 FROM marlowe.contractTxOutPartyRole NATURAL JOIN partyRoles WHERE createTxOut.txId = contractTxOutPartyRole.createTxId AND createTxOut.txIx = contractTxOutPartyRole.createTxIx)) ORDER BY createTxOut.slotNo DESC, createTxOut.txId DESC, createTxOut.txIx DESC OFFSET $8 FETCH NEXT $9 ROWS ONLY
