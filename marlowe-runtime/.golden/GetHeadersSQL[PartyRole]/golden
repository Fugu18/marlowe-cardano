Total count statement: WITH partyRoles (rolesCurrency, role) AS (SELECT * FROM UNNEST($1, $2)) SELECT count(*) FROM marlowe.createTxOut WHERE EXISTS (SELECT 1 FROM marlowe.contractTxOutPartyRole NATURAL JOIN partyRoles WHERE createTxOut.txId = contractTxOutPartyRole.createTxId AND createTxOut.txIx = contractTxOutPartyRole.createTxIx)
Headers statement: WITH partyRoles (rolesCurrency, role) AS (SELECT * FROM UNNEST($1, $2)) SELECT createTxOut.slotNo, createTxOut.blockId, createTxOut.blockNo, createTxOut.txId, createTxOut.txIx, contractTxOut.rolesCurrency, createTxOut.metadata, txOut.address, contractTxOut.payoutScriptHash FROM marlowe.createTxOut NATURAL JOIN marlowe.contractTxOut NATURAL JOIN marlowe.txOut WHERE EXISTS (SELECT 1 FROM marlowe.contractTxOutPartyRole NATURAL JOIN partyRoles WHERE createTxOut.txId = contractTxOutPartyRole.createTxId AND createTxOut.txIx = contractTxOutPartyRole.createTxIx) ORDER BY createTxOut.slotNo DESC, createTxOut.txId DESC, createTxOut.txIx DESC OFFSET $3 FETCH NEXT $4 ROWS ONLY
